# 虚拟形象

::: danger 文档翻译未完成
文档作者是支傲慢无礼的铅笔，他完全放弃了校对和润色工作直到其中的专有名词和表达变得有亿点丈育。
:::

VRChat 提供了专用工具，以帮助您将人物模型转化并上传为VRChat虚拟形象！

## 创建虚拟形象

VRChat Avatar 3.0 SDK（以下简称 Avatar SDK）是 VRChat 为您提供的虚拟形象制作工具。要开始制作虚拟形象，请查看： [制作您的第一个虚拟形象](/creators.vrchat.com/avatars/creating-your-first-avatar)。

技术上来说，VRChat虚拟形象本质上是一个游戏人物3D模型。在左侧的文档目录的“**虚拟形象**”类别中，您可以找到所有关于制作一个**VRChat虚拟形象**的知识。对于将人物模型转化为虚拟形象，我们提供以下重要内容供您参考：

- **[角色绑定](/creators.vrchat.com/avatars/rig-requirements)**：学习如何导入人物模型，并将其转化为游戏角色对象。
- **[性能评级](/creators.vrchat.com/avatars/avatar-performance-ranking-system)**：不同的人物模型可能存在不同的性能评级，例如“Excellent”或“Very poor”，在这里您可以了解到哪些因素会导致较差的性能评级。
- **[模型优化](/creators.vrchat.com/avatars/avatar-optimizing-tips)**：这里将会指导您如何改善和优化人物模型的性能表现。
- **继续阅读本页**，以进一步了解官方提供的虚拟形象制作工具 (VRChat Avatar 3.0 SDK) 。

## 什么是 Avatar 3.0？

**Avatar 3.0** 是我们为 "_VRChat虚拟形象_"  推出的全新特性。相比于已经淘汰的 Avatar 2.0，它可以为人物模型嵌入更加丰富的自定义特性，并带来更好的性能表现。

Avatar 3.0 带来了全新功能：**[模型功能菜单](/docs.vrchat.com/OVERVIEW/controls/action-menu)**！ 强烈建议您先在游戏中试用这个功能，体验其所提供的前所未有的个性化体验！

## 准备工作

- [准备相关软件环境](/creators.vrchat.com/sdk/)
- [制作您的第一个虚拟形象](/creators.vrchat.com/avatars/creating-your-first-avatar)

## 了解概念

为了更好地理解和利用 Avatar SDK 所提供的功能，您需要首先了解一些基本概念。这些信息将有助于您理解一个人物模型的逻辑结构、制作方式，以及如何能更好地结合 Avatar SDK 所提供的功能，以实现其最佳效果。

### Unity 系统

编写本文档时，我们假定您对 [Unity 动画系统](https://docs.unity3d.com/2019.4/Documentation/Manual/class-AnimatorController.html) 稍有了解。特别是，您应确保自己已了解以下方面的基本概念：

- 动画器和动画
- 动画层、层权重和混合
- 动画状态和过渡
- 动画参数
- 状态行为
- Avatar 遮罩

了解以下内容也会有所帮助：

- 状态退出时间
- 动画的循环时间
- （进阶）图层间的时间同步
- （高级）混合树

### 基础功能

至此，您可以尝试为一个人物模型赋予基本的眼动动画和自动嘴型效果。

1. 导入您的人物模型，设置为人形。设置材质等。
2. 添加 `Avatar Descriptor` 组件
3. 如果想要模拟眼球运动效果，请定义眼球骨骼。
4. 如果需要模拟说话嘴型，请定义嘴型效果类型。在 `Rigging 配置界面` 中指定下颏骨骨骼，或嘴型形态键。
5. 设置视角球位置。
6. 点击 `Build & Publish For Windows` 按钮以上传模型！

如果您导入的是一个非人形的模型，请参阅：[通用虚拟形象](#通用虚拟形象) 。

很好! 此时您已获得一个具备了基本功能特性的虚拟形象。它具备最基本的模型手势功能，可以在您说话的时候模拟出对应的嘴型，并且自带最基本的眼部动画效果。这可以让您的虚拟形象在他人眼中具有表现力。

除此之外，Avatar SDK 亦提供了一些便利的功能，为您的模型制作提供便利。

### 本地调试

Avatar SDK 提供了本地调试功能，您无需将其上传至 VRChat 服务器，即可在游戏中对其进行测试。

在 SDK 控制面板的 `Builder` 选项卡中，您现在可以在 `Local Test` 部分选择 `Build and Test`。点击后，您的人物模型将被转化为 VRChat虚拟形象，并保存在一个游戏可以直接读取的文件目录中。

此时启动 VRChat ，您应当可以在 `虚拟形象` 菜单的 `其他模型` 界面中看到它！这个测试虚拟形象只有您能看到。您可以对虚拟形象进行修改，再次点击 `Build and Test`，经过短暂的构建后，您的虚拟形象就会更新。只需在菜单中选择虚拟形象，然后再次点击 `Change`，您就会换上新的测试虚拟形象。

这个虚拟形象只对您可见！对其他人来说，您看起来就像换成本地测试虚拟形象之前的虚拟形象。对于我们的 Avatar 3.0 测试人员来说，这让迭代速度快了很多。希望您喜欢！

要删除复制的本地测试虚拟形象，请进入 VRChat SDK 控制面板的 "内容管理器" 选项卡。您将在底部的 "测试虚拟形象" 部分看到您的虚拟形象。点击 "删除"，当您重新打开虚拟形象菜单时，它将从 "其他" 部分消失。

### 模拟眼球运动

模拟眼动是指您的眼睛会四处移动，观察周围的事物。请注意它不是"眼动追踪"——仅仅是内置动画所实现的行为。但这是让您的虚拟形象看起来更"活灵活现"的好办法。

您可以在编辑器中预览您的设置，并调整虚拟形象的眼睛在各种状态下的外观，这些状态用于决定您的眼骨是如何设置的。

眨眼效果可以通过形态键或骨骼来实现。形态键是最常用的方法，但我们也加入了对骨骼的支持，以改善对某些人物模型的兼容性。

眨眼效果的状态由以下三个参数控制：

- `Blink` - 控制眼睑闭合程度
- `LookUp` - 向上看时使用的参数——用它来调整眼睛/虹膜/眼睑/眉毛的位置
- `LookDown` - 向下看时使用的参数，使用方法与 `LookUp` 相似

如果不想使用，可以将 `LookUp` 和 `LookDown` 设置为 `none`。

此外，您还会注意到两个滑块————一个是从 "冷静" 到 "兴奋"，另一个是从 "害羞" 到 "自信"。冷静/兴奋会影响您眨眼的频率。害羞/自信会影响您看其他玩家的频率，以及您的视线在其他玩家脸上停留的时间，直到您移开视线。

当我们谈到状态行为时，您会了解到更多这方面的信息，但您可以在动画器中设置状态，以便在达到该状态时**禁用眼睛动画**。这样设置后，您就不必担心因为 "快乐" 的心情而闭上眼睛，但眨眼动作仍在进行，从而导致形态键被过度驱动。

### 形态键/基于骨骼的嘴型

如果您只想使用标准的颚骨或形态键视觉效果，我们会为您提供帮助。这两种视觉效果都依然存在，而且运行良好。

此外，您现在还可以配置颚瓣骨视觉特效的角度，进行额外的自定义！

不过，在Avatar 3.0 中，您还可以访问动画参数，该参数可指示当前应播放哪个虚拟形象！这就意味着，只要您能制作动画，**您就能在虚拟形象中使用它。** 不再需要为二维嘴巴、机器人或其他任何东西耍花招——您可以为虚拟形象制作任何您喜欢的动画。

在所有虚拟形象模式中，"虚拟形象" 动画参数都会更新。

### 代理动画

您可能会注意到，SDK 包含大量名为 `proxy_animationName` 的动画。这些动画是各种默认 VRChat 动画的 "占位符"。如果您使用了以 `proxy_` 开头的动画，VRChat 会尝试用内置动画替换它。这可以在任何可播放层中进行。

虽然如果前缀为 `proxy_` 的动画后缀与我们的内置动画不匹配，我们将不会替换该动画，但最好还是避免将任何动画命名为前缀为 `proxy_` 的动画。

### 运动动画（Locomotion Animation）

这是 Avatar Descriptor 中的一个选项。默认为开启。

**使用自动脚步** 仅适用于 3 点或 4 点跟踪。关闭该选项意味着您将禁用用于房间尺度移动的程序化下半身动画。在三点或四点追踪模式下，当您在房间空间中移动时，程序动画就会播放。

如果开启自动脚步（默认状态），则仍可通过 `追踪控制` 状态行为启用/禁用追踪。

如果 `自动脚步` 处于关闭状态，则启用/禁用腿部和髋部的追踪功能将不起任何作用，您将始终依靠动画来驱动下半身。

#### 被动运动动画

这是Avatar 3.0 Avatar Descriptor 中的一个选项。默认为开启。

**被动运动动画** 默认为开启。它仅适用于 6 点跟踪（全身跟踪）。当 `运动动画` 开启时，在全身追踪中运动（如移动操纵杆）将播放由基础可玩层决定的行走/奔跑动画。

当 `运动动画` 关闭时，在全身追踪中移动将不会播放行走/奔跑动画。如果您希望用全身追踪动作来 `模仿` 您的行走，这将非常有用。**如果要关闭 "运动动画"，请不要使用默认的基础层和添加层！**

### 写入默认状态

[写入默认值](https://docs.unity3d.com/2019.4/Documentation/Manual/class-State.html) 是 Unity 中动画器状态的一个选项。

如果写入默认值"（Write Defaults）设置为 "开" ，当进入一个状态前，动画器会自动将动画中每个物体的所有属性重置为它们的默认值。如果您没有设置好，这可能会导致一些非常奇怪状态。

Unity 在向 5.0 版迁移时添加了这一功能。这样做是为了避免依赖于写入所有默认属性行为的已有资产和项目发生故障。

通常情况下，当您与其他游戏开发者在一个项目上合作时，通常会商定一个标准。在 VRChat，我们都是游戏开发者，因此我们必须在这里设定标准。

VRChat 在内置动画器和示例动画器中不使用 "写入默认值"（Write Defaults）。这意味着只有动画中的实际属性才会被任何一个动画器节点播放。我们建议创作者也遵循这一工作流程，因为这样更容易跟踪哪些属性将通过任何特定层播放动画，而且也符合整个 Unity 的预期用途。

创建新节点时，"写入默认值"（Write Defaults）默认为**开**，因此创作者必须知道他们必须取消选中此值。如果您想使用 "写入默认值"，就必须跟踪启用该选项的节点可能写入的所有属性。

**我们建议将 "写入默认值 "功能关闭，并明确动画器需要设置的任何参数。**请注意，这可能需要添加 "重置 "动画，或在动画中添加属性，以便在特定方向上 "初始化 "变换。

综上所述，如果您要使用更高级的用例和设置，使用 "写入默认值 "可能会更有优势。

#### 通用虚拟形象

Avatar 3.0 也支持非人形的通用虚拟形象。如果您想使用 Avatar 3.0 人形模型的类似功能，您需要遵循以下几条准则：

- 将通用模型导入 FBX，并将其指定为 `通用` Rig 类型，这样就创建了一个虚拟形象对象
- 确保虚拟形象对象在动画器组件的虚拟形象字段中被引用（与虚拟形象描述符相同的游戏对象）。
- 将动画器控制器留空（运行时会被剥离），并使用 "可播放层" 来定义您的自定义动画控制器。通用虚拟形象有 3 个可播放层： 基础层、动作层和特效层，因为其他层是人形特有的。

如果不按照这些步骤操作，您的通用虚拟形象将无法使用许多 Avatars 3.0 功能，如表情参数和状态行为。如果您不介意，可以直接在根动画器中添加一个动画控制器，将虚拟形象字段留空。如果您只是在 Unity 中构建一个静态对象的层次结构，并想要一个简单的动画器，那么这种方法可能会很有用。
